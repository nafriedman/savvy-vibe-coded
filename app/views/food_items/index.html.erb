<div class="page-wrapper">
  <div class="filter-section">
    <form id="filter-form" class="filter-form">
      <div class="filter-compact">
        <select name="sort" id="sort-select" class="filter-compact-select">
          <option value="">Sort</option>
          <option value="expiration_date" <%= 'selected' if params[:sort] == 'expiration_date' %>>Expiration Date</option>
          <option value="name" <%= 'selected' if params[:sort] == 'name' %>>Name</option>
          <option value="purchase_date" <%= 'selected' if params[:sort] == 'purchase_date' %>>Purchase Date</option>
        </select>

        <select name="status" id="status-select" class="filter-compact-select">
          <option value="">Status</option>
          <option value="available" <%= 'selected' if params[:status] == 'available' %>>Available</option>
          <option value="consumed" <%= 'selected' if params[:status] == 'consumed' %>>Consumed</option>
          <option value="thrown_out" <%= 'selected' if params[:status] == 'thrown_out' %>>Thrown out</option>
          <option value="given_away" <%= 'selected' if params[:status] == 'given_away' %>>Given away</option>
        </select>

        <select name="category" id="category-select" class="filter-compact-select">
          <option value="">Category</option>
          <option value="fresh" <%= 'selected' if params[:category] == 'fresh' %>>Fresh</option>
          <option value="prepared" <%= 'selected' if params[:category] == 'prepared' %>>Prepared</option>
          <option value="pantry" <%= 'selected' if params[:category] == 'pantry' %>>Pantry</option>
        </select>

        <select name="expiry_filter" id="expiry-select" class="filter-compact-select">
          <option value="">Expiry</option>
          <option value="expired" <%= 'selected' if params[:expiry_filter] == 'expired' %>>Expired</option>
          <option value="expiring_soon" <%= 'selected' if params[:expiry_filter] == 'expiring_soon' %>>Expiring Soon (3 days)</option>
          <option value="expiring_week" <%= 'selected' if params[:expiry_filter] == 'expiring_week' %>>This Week (7 days)</option>
          <option value="fresh" <%= 'selected' if params[:expiry_filter] == 'fresh' %>>Fresh (7+ days)</option>
        </select>

        <% if params[:sort].present? || params[:status].present? || params[:category].present? || params[:expiry_filter].present? %>
          <a href="<%= food_items_path %>" class="filter-clear-btn">Clear</a>
        <% end %>
      </div>
    </form>
  </div>

  <% if @food_items.any? %>
    <div class="cards-grid">
      <% @food_items.each do |food_item| %>
        <div class="card #{status_class(food_item)}" data-item-id="<%= food_item.id %>">
          <a href="<%= food_item_path(food_item) %>" class="card-link">
            <div class="card-top">
              <div class="card-name"><%= food_item.name %></div>
              <div class="card-category"><%= food_item.food.category.humanize %></div>
            </div>

            <div class="card-info">
              <div class="info-row">
                <span class="info-label">Qty</span>
                <span class="info-value"><%= food_item.quantity %> <%= food_item.unit %></span>
              </div>
              <div class="info-row">
                <span class="info-label">Location</span>
                <span class="info-value"><%= food_item.storage_location || 'N/A' %></span>
              </div>
            </div>

            <div class="card-expiry">
              <div class="expiry-label">Expires</div>
              <div class="expiry-date <%= expiration_class(food_item.expiration_date) %>">
                <%= food_item.expiration_date.strftime('%b %d') %>
              </div>
              <div class="expiry-countdown">
                <%= days_until_expiration(food_item.expiration_date) %>
              </div>
            </div>
          </a>

          <% if food_item.available? %>
            <div class="card-actions">
              <button class="action-btn consumed" data-action="update-status" data-id="<%= food_item.id %>" data-status="consumed" title="Mark as consumed">✓</button>
              <button class="action-btn thrown" data-action="update-status" data-id="<%= food_item.id %>" data-status="thrown_out" title="Mark as thrown out">✕</button>
              <a href="<%= edit_food_item_path(food_item) %>" class="action-btn edit" title="Edit">Edit</a>
            </div>
          <% else %>
            <div class="card-status-badge"><%= food_item.status.humanize %></div>
          <% end %>
        </div>
      <% end %>
    </div>
  <% else %>
    <div class="empty-state">
      <p>No food items found</p>
      <%= link_to "Add your first item", new_food_item_path, class: "btn-add" %>
    </div>
  <% end %>
</div>
